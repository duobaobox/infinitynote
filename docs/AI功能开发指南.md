# InfinityNote2 AI åŠŸèƒ½å¼€å‘æŒ‡å—

> **ç‰ˆæœ¬**: 2.0 | **æ›´æ–°æ—¶é—´**: 2025-09-16 | **æ¶æ„å¸ˆå®¡æŸ¥**: âœ… å·²é€šè¿‡

## ğŸ” æ¶æ„å¸ˆå®¡æŸ¥æ‘˜è¦

**è¯„ä¼°ç­‰çº§**: B+ (7.5/10) - æ€»ä½“æ€è·¯æ­£ç¡®ï¼Œå®ç°ç»†èŠ‚éœ€è°ƒæ•´

- âœ… **æ•°æ®ç»“æ„è®¾è®¡**: ä¼˜ç§€ (9/10) - å®Œç¾åˆ©ç”¨ç°æœ‰æ‰©å±•æ€§
- âš ï¸ **ç»„ä»¶æ¶æ„**: éœ€é‡æ„ (5/10) - è¿‡åº¦å¤æ‚åŒ–ï¼Œéœ€ç®€åŒ–é›†æˆ
- âœ… **æœåŠ¡å±‚è®¾è®¡**: è‰¯å¥½ (7/10) - åŸºç¡€åˆç†ï¼Œéœ€ç»Ÿä¸€æ¨¡å¼
- âš ï¸ **çŠ¶æ€ç®¡ç†**: éœ€è°ƒæ•´ (6/10) - åº”é›†æˆç°æœ‰ store è€Œéç‹¬ç«‹
- âš ï¸ **å®‰å…¨æ€§**: éœ€å®Œå–„ (6/10) - API å¯†é’¥ç®¡ç†éœ€åŠ å¼º

## 1. èƒŒæ™¯ä¸ç›®æ ‡

æœ¬æŒ‡å—é¢å‘ InfinityNote2 é¡¹ç›®å¼€å‘è€…ï¼Œæ—¨åœ¨æŒ‡å¯¼å¦‚ä½•**æ¶æ„ä¸€è‡´ã€ä½ä¾µå…¥**åœ°é›†æˆ AI ä¾¿ç­¾ç”ŸæˆåŠŸèƒ½ï¼ˆå«æ€ç»´é“¾ï¼‰ï¼Œå®ç° MVP ç‰ˆæœ¬å¹¶ä¸ºåç»­æ‰©å±•æ‰“ä¸‹åŸºç¡€ã€‚

**æ ¸å¿ƒæ¶æ„åŸåˆ™**ï¼š

- ğŸ¯ **æœ€å°ä¾µå…¥**ï¼šå……åˆ†åˆ©ç”¨ç°æœ‰ `customProperties` æ‰©å±•æ€§
- ğŸ”„ **æ¶æ„ä¸€è‡´**ï¼šéµå¾ªç°æœ‰ç»„ä»¶å’ŒæœåŠ¡çš„è®¾è®¡æ¨¡å¼
- ğŸ›¡ï¸ **å‘åå…¼å®¹**ï¼šä¸ç ´åç°æœ‰åŠŸèƒ½å’Œç”¨æˆ·æ•°æ®
- âš¡ **æ€§èƒ½ä¼˜å…ˆ**ï¼šé›†æˆç°æœ‰çš„é˜²æŠ–å’Œæ€§èƒ½ä¼˜åŒ–æœºåˆ¶

## 2. æŠ€æœ¯é€‰å‹ä¸æ¶æ„å…¼å®¹æ€§

- **å‰ç«¯æ¡†æ¶**ï¼šReact 19 + TypeScript âœ…
- **çŠ¶æ€ç®¡ç†**ï¼šZustand âœ… (é›†æˆç°æœ‰ noteStore)
- **å¯Œæ–‡æœ¬ç¼–è¾‘å™¨**ï¼šTipTap 3.4.2 âœ… (æ‰©å±•æ€ç»´é“¾æ˜¾ç¤º)
- **æœ¬åœ°å­˜å‚¨**ï¼šDexieï¼ˆIndexedDBï¼‰âœ… (ä½¿ç”¨ customProperties)
- **UI ç»„ä»¶**ï¼šAnt Design 5.27.3 âœ… (é›†æˆç°æœ‰å·¥å…·æ )
- **æ„å»ºå·¥å…·**ï¼šVite 7.1.2 âœ…
- **æ¨è AI æœåŠ¡å•†**ï¼šæ™ºè°± AIï¼ˆGLM-4ï¼‰ï¼Œå¤‡é€‰ OpenAIï¼ˆGPT-4oï¼‰

> **æ¶æ„å¸ˆéªŒè¯**ï¼šç°æœ‰æ¶æ„ä¸ AI åŠŸèƒ½é«˜åº¦å…¼å®¹ï¼Œæ— éœ€å¤§å¹…è°ƒæ•´ã€‚

## 3. æ ¸å¿ƒæ¶æ„è®¾è®¡ï¼ˆä¼˜åŒ–ç‰ˆï¼‰

### 3.1 æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€ AI æœåŠ¡å±‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  aiService.ts (ç»Ÿä¸€APIè°ƒç”¨)       â”‚
â”‚  aiConfigService.ts (é…ç½®ç®¡ç†)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€ çŠ¶æ€ç®¡ç†å±‚ â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  noteStore.ts   â”‚æ‰©å±•AIæ–¹æ³•      â”‚ â† é›†æˆç°æœ‰store
â”‚  (ç°æœ‰)         â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
â”Œâ”€ ç»„ä»¶å±‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NoteToolbar    â”‚+ AIæŒ‰é’®        â”‚ â† ç°æœ‰ç»„ä»¶æ‰©å±•
â”‚  TiptapEditor   â”‚+ æ€ç»´é“¾æ‰©å±•     â”‚ â† ç°æœ‰ç¼–è¾‘å™¨æ‰©å±•
â”‚  NoteCard       â”‚ä¿æŒç°æœ‰ç»“æ„     â”‚ â† æ— éœ€ä¿®æ”¹
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 UI é›†æˆç­–ç•¥ï¼ˆä¿®æ­£ç‰ˆï¼‰

**ç°æœ‰ NoteCard ç»“æ„ä¿æŒä¸å˜**ï¼š

```tsx
// ç°æœ‰ç»“æ„ï¼Œæ— éœ€ä¿®æ”¹
<div className={styles.noteCardContainer}>
  <div className={styles.noteCard}>
    <div className={styles.noteHeader}>
      <h3>{note.title}</h3>
    </div>
    <div className={styles.noteContent}>
      <TiptapEditor /> {/* åœ¨æ­¤å†…éƒ¨é›†æˆæ€ç»´é“¾ */}
    </div>
  </div>
  <NoteToolbar /> {/* åœ¨æ­¤æ·»åŠ AIæŒ‰é’® */}
</div>
```

### 3.3 æ€ç»´é“¾é›†æˆæ–¹æ¡ˆï¼ˆæ¶æ„å¸ˆä¼˜åŒ–ï¼‰


**âœ… ä¼˜åŒ–æ–¹æ¡ˆ**ï¼šé›†æˆåˆ° TipTap ç¼–è¾‘å™¨å†…éƒ¨

```tsx
// TiptapEditor.tsx - æ‰©å±•æ€ç»´é“¾æ˜¾ç¤º
export const TiptapEditor = memo<TiptapEditorProps>(() => {
  // ... ç°æœ‰é€»è¾‘ä¿æŒä¸å˜

  // æ–°å¢ï¼šAIæ€ç»´é“¾æ•°æ®è·å–
  const aiData = note.customProperties?.ai;
  const showThinkingChain = shouldShowThinkingChain(note, aiData);

  return (
    <TiptapEditorErrorBoundary>
      <div className={containerClassName} style={editorStyle}>
        {/* æ–°å¢ï¼šæ€ç»´é“¾æ˜¾ç¤ºåŒºåŸŸï¼ˆæ¡ä»¶æ¸²æŸ“ï¼‰ */}
        {showThinkingChain && (
          <ThinkingChainDisplay
            thinkingData={aiData.thinkingChain}
            isCollapsed={aiData.thinkingCollapsed ?? true}
            onToggle={handleThinkingToggle}
          />
        )}

        {/* ç°æœ‰ï¼šç¼–è¾‘å™¨å†…å®¹åŒºåŸŸ */}
        <EditorContent editor={editor} className="tiptap-editor-content" />

        {/* ç°æœ‰ï¼šå·¥å…·æ  */}
        {editor && <Toolbar editor={editor} config={toolbarConfig} />}
      </div>
    </TiptapEditorErrorBoundary>
  );
});

// æ€ç»´é“¾æ˜¾ç¤ºé€»è¾‘ï¼ˆç®€åŒ–ç‰ˆï¼‰
const shouldShowThinkingChain = (note: Note, aiData?: any): boolean => {
  return !!(
    (
      aiData?.generated && // AIç”Ÿæˆçš„ä¾¿ç­¾
      aiData?.model && // æœ‰AIæ¨¡å‹ä¿¡æ¯
      aiData?.thinkingChain && // æœ‰æ€ç»´é“¾æ•°æ®
      aiData?.showThinking !== false
    ) // ç”¨æˆ·æœªå…³é—­æ˜¾ç¤º
  );
};
```

### 3.4 å·¥å…·æ é›†æˆæ–¹æ¡ˆ

```tsx
// NoteToolbar.tsx - æ·»åŠ AIåŠŸèƒ½æŒ‰é’®
export const NoteToolbar: React.FC<NoteToolbarProps> = ({
  noteId,
  onAction,
}) => {
  return (
    <div className={styles.noteToolbar}>
      {/* ç°æœ‰æŒ‰é’®ä¿æŒä¸å˜ */}
      <Button icon={<DeleteOutlined />} onClick={() => onAction("delete")} />
      <Button icon={<CopyOutlined />} onClick={() => onAction("duplicate")} />

      {/* æ–°å¢ï¼šAIåŠŸèƒ½æŒ‰é’® */}
      <Button
        icon={<RobotOutlined />}
        onClick={() => onAction("ai-generate")}
        title="AIç”Ÿæˆå†…å®¹"
      />
      <Button
        icon={<SettingOutlined />}
        onClick={() => onAction("ai-config")}
        title="AIè®¾ç½®"
      />
    </div>
  );
};
```

## 4. æ•°æ®ç»“æ„è®¾è®¡ï¼ˆæ¶æ„å¸ˆéªŒè¯ç‰ˆï¼‰

### 4.1 Note ç±»å‹æ‰©å±•ï¼ˆâœ… ä¼˜ç§€è®¾è®¡ï¼‰

**æ¶æ„å¸ˆè¯„ä¼°**ï¼šç°æœ‰ Note æ¥å£çš„ `customProperties` å­—æ®µè®¾è®¡ä¼˜ç§€ï¼Œä¸º AI åŠŸèƒ½æä¾›äº†å®Œç¾çš„æ‰©å±•ç‚¹ã€‚

```typescript
// ç°æœ‰ Note æ¥å£ï¼ˆæ— éœ€ä¿®æ”¹ï¼‰
export interface Note {
  // ... ç°æœ‰å­—æ®µä¿æŒä¸å˜

  /** è‡ªå®šä¹‰å±æ€§ - AIåŠŸèƒ½çš„å®Œç¾æ‰©å±•ç‚¹ */
  customProperties?: Record<string, any>;
}

// AI æ•°æ®ç»“æ„å®šä¹‰
interface AICustomProperties {
  ai?: {
    // åŸºç¡€ä¿¡æ¯
    generated: boolean; // æ˜¯å¦AIç”Ÿæˆ
    model: string; // ä½¿ç”¨çš„AIæ¨¡å‹
    provider: string; // AIæœåŠ¡æä¾›å•†
    generatedAt: string; // ç”Ÿæˆæ—¶é—´

    // ç”Ÿæˆå‚æ•°
    prompt: string; // ç”¨æˆ·è¾“å…¥çš„æç¤º
    temperature?: number; // ç”Ÿæˆæ¸©åº¦
    maxTokens?: number; // æœ€å¤§tokenæ•°

    // æ€ç»´é“¾æ•°æ®ï¼ˆå¦‚æœæ”¯æŒï¼‰
    thinkingChain?: {
      steps: Array<{
        id: string;
        content: string;
        timestamp: number;
      }>;
      summary: string;
      totalSteps: number;
    };

    // UIçŠ¶æ€
    showThinking?: boolean; // æ˜¯å¦æ˜¾ç¤ºæ€ç»´é“¾
    thinkingCollapsed?: boolean; // æ€ç»´é“¾æ˜¯å¦æŠ˜å 

    // å…ƒæ•°æ®
    requestId: string; // è¯·æ±‚IDï¼Œç”¨äºè°ƒè¯•
    cost?: {
      // æˆæœ¬ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰
      inputTokens: number;
      outputTokens: number;
      totalCost: number;
    };
  };
}

// ä½¿ç”¨ç¤ºä¾‹
const aiNote: Note = {
  id: "note_123",
  title: "AIç”Ÿæˆçš„ä¾¿ç­¾",
  content: "<p>AIç”Ÿæˆçš„å†…å®¹...</p>",
  customProperties: {
    ai: {
      generated: true,
      model: "glm-4-plus",
      provider: "zhipu",
      generatedAt: "2025-09-16T10:00:00Z",
      prompt: "ç”¨æˆ·çš„åŸå§‹æç¤º",
      thinkingChain: {
        steps: [
          {
            id: "step1",
            content: "åˆ†æç”¨æˆ·éœ€æ±‚...",
            timestamp: 1726480800000,
          },
        ],
        summary: "é€šè¿‡3æ­¥æ¨ç†å¾—å‡ºç»“è®º",
        totalSteps: 3,
      },
      showThinking: true,
      thinkingCollapsed: false,
      requestId: "req_abc123",
    },
  },
  // ... å…¶ä»–å­—æ®µ
};
```

### 4.2 æ•°æ®å­˜å‚¨ç­–ç•¥

**âœ… æ¶æ„å¸ˆæ¨è**ï¼šä½¿ç”¨ç°æœ‰å­˜å‚¨æœºåˆ¶ï¼Œæ— éœ€ schema å˜æ›´

```typescript
// åœ¨ç°æœ‰ noteService.ts ä¸­æ‰©å±•æ–¹æ³•
export class NoteService {
  // ç°æœ‰æ–¹æ³•ä¿æŒä¸å˜...

  // æ–°å¢ï¼šä¿å­˜AIç”Ÿæˆçš„ä¾¿ç­¾
  static async saveAINote(
    noteData: Partial<Note>,
    aiData: AICustomProperties["ai"]
  ): Promise<string> {
    const noteWithAI: Partial<Note> = {
      ...noteData,
      customProperties: {
        ...noteData.customProperties,
        ai: aiData,
      },
    };

    return await this.createNote(noteWithAI);
  }

  // æ–°å¢ï¼šæ›´æ–°AIæ•°æ®
  static async updateAIData(
    noteId: string,
    aiData: Partial<AICustomProperties["ai"]>
  ): Promise<void> {
    const note = await this.getNoteById(noteId);
    if (note) {
      const updatedProperties = {
        ...note.customProperties,
        ai: {
          ...note.customProperties?.ai,
          ...aiData,
        },
      };

      await this.updateNote(noteId, { customProperties: updatedProperties });
    }
  }
}
```

## 5. çŠ¶æ€ç®¡ç†è®¾è®¡ï¼ˆæ¶æ„å¸ˆä¼˜åŒ–ï¼‰

### 5.1 é›†æˆåˆ°ç°æœ‰ noteStoreï¼ˆâœ… æ¨èæ–¹æ¡ˆï¼‰

**âŒ åŸæ–¹æ¡ˆé—®é¢˜**ï¼šç‹¬ç«‹çš„ aiStore å¯¼è‡´çŠ¶æ€åˆ†æ•£ï¼Œå¢åŠ å¤æ‚åº¦
**âœ… ä¼˜åŒ–æ–¹æ¡ˆ**ï¼šæ‰©å±•ç°æœ‰ noteStoreï¼Œä¿æŒçŠ¶æ€ç»Ÿä¸€

```typescript
// src/store/noteStore.ts - æ‰©å±•AIåŠŸèƒ½
interface NoteState {
  // ... ç°æœ‰çŠ¶æ€ä¿æŒä¸å˜

  // æ–°å¢ï¼šAIç›¸å…³çŠ¶æ€
  aiGenerating: Record<string, boolean>; // æ­£åœ¨ç”ŸæˆAIå†…å®¹çš„ä¾¿ç­¾
  aiStreamingData: Record<string, string>; // æµå¼ç”Ÿæˆçš„å®æ—¶æ•°æ®
  aiErrors: Record<string, string>; // AIç”Ÿæˆé”™è¯¯ä¿¡æ¯
}

interface NoteActions {
  // ... ç°æœ‰æ–¹æ³•ä¿æŒä¸å˜

  // æ–°å¢ï¼šAIç›¸å…³æ–¹æ³•
  startAIGeneration: (noteId: string, prompt: string) => Promise<void>;
  updateAIStreamingContent: (noteId: string, content: string) => void;
  completeAIGeneration: (
    noteId: string,
    finalContent: string,
    aiData: any
  ) => Promise<void>;
  cancelAIGeneration: (noteId: string) => void;
  toggleThinkingChain: (noteId: string) => Promise<void>;
}

// åœ¨ç°æœ‰ useNoteStore ä¸­æ·»åŠ AIæ–¹æ³•
export const useNoteStore = create<NoteStore>()(
  devtools((set, get) => ({
    // ... ç°æœ‰çŠ¶æ€å’Œæ–¹æ³•ä¿æŒä¸å˜

    // æ–°å¢ï¼šAIç›¸å…³çŠ¶æ€
    aiGenerating: {},
    aiStreamingData: {},
    aiErrors: {},

    // æ–°å¢ï¼šå¼€å§‹AIç”Ÿæˆ
    startAIGeneration: async (noteId: string, prompt: string) => {
      try {
        set((state) => ({
          aiGenerating: { ...state.aiGenerating, [noteId]: true },
          aiErrors: { ...state.aiErrors, [noteId]: undefined },
        }));

        // è°ƒç”¨AIæœåŠ¡
        await aiService.generateNote({
          noteId,
          prompt,
          onStream: (content) =>
            get().updateAIStreamingContent(noteId, content),
          onComplete: (finalContent, aiData) =>
            get().completeAIGeneration(noteId, finalContent, aiData),
          onError: (error) =>
            set((state) => ({
              aiErrors: { ...state.aiErrors, [noteId]: error.message },
              aiGenerating: { ...state.aiGenerating, [noteId]: false },
            })),
        });
      } catch (error) {
        console.error("AIç”Ÿæˆå¤±è´¥:", error);
        set((state) => ({
          aiErrors: { ...state.aiErrors, [noteId]: error.message },
          aiGenerating: { ...state.aiGenerating, [noteId]: false },
        }));
      }
    },

    // æ–°å¢ï¼šæ›´æ–°æµå¼å†…å®¹
    updateAIStreamingContent: (noteId: string, content: string) => {
      set((state) => ({
        aiStreamingData: { ...state.aiStreamingData, [noteId]: content },
      }));
    },

    // æ–°å¢ï¼šå®ŒæˆAIç”Ÿæˆ
    completeAIGeneration: async (
      noteId: string,
      finalContent: string,
      aiData: any
    ) => {
      try {
        // æ›´æ–°ä¾¿ç­¾å†…å®¹å’ŒAIæ•°æ®
        await get().updateNote(noteId, {
          content: finalContent,
          customProperties: {
            ...get().notes.find((n) => n.id === noteId)?.customProperties,
            ai: aiData,
          },
        });

        // æ¸…ç†ä¸´æ—¶çŠ¶æ€
        set((state) => ({
          aiGenerating: { ...state.aiGenerating, [noteId]: false },
          aiStreamingData: { ...state.aiStreamingData, [noteId]: undefined },
        }));

        console.log(`âœ… AIç”Ÿæˆå®Œæˆï¼Œä¾¿ç­¾ID: ${noteId}`);
      } catch (error) {
        console.error("ä¿å­˜AIç”Ÿæˆå†…å®¹å¤±è´¥:", error);
        set((state) => ({
          aiErrors: { ...state.aiErrors, [noteId]: error.message },
          aiGenerating: { ...state.aiGenerating, [noteId]: false },
        }));
      }
    },

    // æ–°å¢ï¼šåˆ‡æ¢æ€ç»´é“¾æ˜¾ç¤º
    toggleThinkingChain: async (noteId: string) => {
      const note = get().notes.find((n) => n.id === noteId);
      if (note?.customProperties?.ai) {
        const currentShow = note.customProperties.ai.showThinking ?? true;
        await get().updateNote(noteId, {
          customProperties: {
            ...note.customProperties,
            ai: {
              ...note.customProperties.ai,
              showThinking: !currentShow,
            },
          },
        });
      }
    },
  }))
);
```

## 6. AI æœåŠ¡å±‚è®¾è®¡ï¼ˆæ¶æ„å¸ˆä¼˜åŒ–ï¼‰

### 6.1 éµå¾ªç°æœ‰æœåŠ¡æ¨¡å¼

**å‚è€ƒç°æœ‰ `noteService.ts` çš„è®¾è®¡æ¨¡å¼**ï¼š

```typescript
// src/services/aiService.ts
import { AICustomProperties } from "../types/ai";

interface AIGenerationOptions {
  noteId: string;
  prompt: string;
  model?: string;
  temperature?: number;
  maxTokens?: number;
  onStream?: (content: string) => void;
  onComplete?: (finalContent: string, aiData: AICustomProperties["ai"]) => void;
  onError?: (error: Error) => void;
}

interface AIProvider {
  name: string;
  generateContent: (options: AIGenerationOptions) => Promise<void>;
  supportedModels: string[];
  supportsStreaming: boolean;
  supportsThinking: boolean;
}

class AIService {
  private providers: Map<string, AIProvider> = new Map();
  private currentProvider: string = "zhipu";

  constructor() {
    this.initializeProviders();
  }

  private initializeProviders() {
    // æ™ºè°±AIæä¾›å•†
    this.providers.set("zhipu", new ZhipuAIProvider());

    // OpenAIæä¾›å•†
    this.providers.set("openai", new OpenAIProvider());
  }

  async generateNote(options: AIGenerationOptions): Promise<void> {
    try {
      const provider = this.providers.get(this.currentProvider);
      if (!provider) {
        throw new Error(`AIæä¾›å•† ${this.currentProvider} ä¸å¯ç”¨`);
      }

      await provider.generateContent(options);
    } catch (error) {
      console.error("AIç”Ÿæˆå¤±è´¥:", error);
      options.onError?.(error as Error);
      throw error;
    }
  }

  setProvider(providerName: string) {
    if (this.providers.has(providerName)) {
      this.currentProvider = providerName;
    } else {
      throw new Error(`ä¸æ”¯æŒçš„AIæä¾›å•†: ${providerName}`);
    }
  }

  getAvailableProviders(): string[] {
    return Array.from(this.providers.keys());
  }
}

// æ™ºè°±AIæä¾›å•†å®ç°
class ZhipuAIProvider implements AIProvider {
  name = "zhipu";
  supportedModels = ["glm-4", "glm-4-plus"];
  supportsStreaming = true;
  supportsThinking = true;

  async generateContent(options: AIGenerationOptions): Promise<void> {
    const apiKey = this.getApiKey();
    if (!apiKey) {
      throw new Error("æ™ºè°±AI APIå¯†é’¥æœªé…ç½®");
    }

    try {
      const response = await fetch(
        "https://open.bigmodel.cn/api/paas/v4/chat/completions",
        {
          method: "POST",
          headers: {
            Authorization: `Bearer ${apiKey}`,
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            model: options.model || "glm-4",
            messages: [
              {
                role: "user",
                content: options.prompt,
              },
            ],
            stream: true,
            temperature: options.temperature || 0.7,
            max_tokens: options.maxTokens || 1000,
          }),
        }
      );

      if (!response.ok) {
        throw new Error(`APIè¯·æ±‚å¤±è´¥: ${response.statusText}`);
      }

      await this.handleStreamResponse(response, options);
    } catch (error) {
      console.error("æ™ºè°±AI APIè°ƒç”¨å¤±è´¥:", error);
      throw error;
    }
  }

  private async handleStreamResponse(
    response: Response,
    options: AIGenerationOptions
  ) {
    const reader = response.body?.getReader();
    if (!reader) throw new Error("æ— æ³•è¯»å–å“åº”æµ");

    let fullContent = "";
    let thinkingChain: any[] = [];

    try {
      while (true) {
        const { done, value } = await reader.read();
        if (done) break;

        const chunk = new TextDecoder().decode(value);
        const lines = chunk.split("\n").filter((line) => line.trim());

        for (const line of lines) {
          if (line.startsWith("data: ")) {
            const data = line.slice(6);
            if (data === "[DONE]") continue;

            try {
              const parsed = JSON.parse(data);
              const content = parsed.choices?.[0]?.delta?.content || "";

              if (content) {
                fullContent += content;
                options.onStream?.(fullContent);
              }

              // è§£ææ€ç»´é“¾ï¼ˆå¦‚æœæ”¯æŒï¼‰
              if (parsed.choices?.[0]?.delta?.thinking) {
                thinkingChain.push({
                  id: `step_${thinkingChain.length + 1}`,
                  content: parsed.choices[0].delta.thinking,
                  timestamp: Date.now(),
                });
              }
            } catch (e) {
              console.warn("è§£æå“åº”æ•°æ®å¤±è´¥:", e);
            }
          }
        }
      }

      // æ„é€ AIæ•°æ®
      const aiData: AICustomProperties["ai"] = {
        generated: true,
        model: options.model || "glm-4",
        provider: "zhipu",
        generatedAt: new Date().toISOString(),
        prompt: options.prompt,
        requestId: `req_${Date.now()}`,
        showThinking: true,
        thinkingCollapsed: false,
      };

      if (thinkingChain.length > 0) {
        aiData.thinkingChain = {
          steps: thinkingChain,
          summary: `é€šè¿‡${thinkingChain.length}æ­¥æ¨ç†å®Œæˆ`,
          totalSteps: thinkingChain.length,
        };
      }

      options.onComplete?.(fullContent, aiData);
    } finally {
      reader.releaseLock();
    }
  }

  private getApiKey(): string | null {
    return localStorage.getItem("ai_zhipu_api_key");
  }
}

export const aiService = new AIService();
```

## 7. ç»„ä»¶å®ç°ï¼ˆæ¶æ„å¸ˆä¼˜åŒ–ï¼‰

### 7.1 æ€ç»´é“¾æ˜¾ç¤ºç»„ä»¶

```tsx
// src/components/TiptapEditor/ThinkingChainDisplay.tsx
import React, { memo, useState } from "react";
import { Collapse, Typography, Tag } from "antd";
import { BrainOutlined, ClockCircleOutlined } from "@ant-design/icons";
import styles from "./ThinkingChainDisplay.module.css";

interface ThinkingChainDisplayProps {
  thinkingData: {
    steps: Array<{
      id: string;
      content: string;
      timestamp: number;
    }>;
    summary: string;
    totalSteps: number;
  };
  isCollapsed: boolean;
  onToggle: () => void;
}

export const ThinkingChainDisplay = memo<ThinkingChainDisplayProps>(
  ({ thinkingData, isCollapsed, onToggle }) => {
    const formatTime = (timestamp: number) => {
      return new Date(timestamp).toLocaleTimeString();
    };

    const items = [
      {
        key: "thinking",
        label: (
          <div className={styles.thinkingHeader}>
            <BrainOutlined className={styles.thinkingIcon} />
            <span>AI æ€ç»´è¿‡ç¨‹</span>
            <Tag color="blue" className={styles.stepCount}>
              {thinkingData.totalSteps} æ­¥
            </Tag>
          </div>
        ),
        children: (
          <div className={styles.thinkingContent}>
            {thinkingData.steps.map((step, index) => (
              <div key={step.id} className={styles.thinkingStep}>
                <div className={styles.stepHeader}>
                  <span className={styles.stepNumber}>æ­¥éª¤ {index + 1}</span>
                  <span className={styles.stepTime}>
                    <ClockCircleOutlined /> {formatTime(step.timestamp)}
                  </span>
                </div>
                <div className={styles.stepContent}>{step.content}</div>
              </div>
            ))}
            <div className={styles.thinkingSummary}>
              <Typography.Text type="secondary">
                ğŸ’¡ {thinkingData.summary}
              </Typography.Text>
            </div>
          </div>
        ),
      },
    ];

    return (
      <div className={styles.thinkingChainContainer}>
        <Collapse
          items={items}
          activeKey={isCollapsed ? [] : ["thinking"]}
          onChange={onToggle}
          ghost
          size="small"
        />
      </div>
    );
  }
);
```

### 7.2 AI è®¾ç½®æ ‡ç­¾é¡µ

```tsx
// src/components/SettingsModal/tabs/AISettingsTab.tsx
import React, { memo, useState, useEffect } from "react";
import { Form, Input, Select, Slider, Switch, Button, message } from "antd";
import { RobotOutlined, KeyOutlined } from "@ant-design/icons";
import { aiService } from "../../../services/aiService";
import styles from "../SettingsModal.module.css";

interface AISettings {
  provider: string;
  apiKeys: Record<string, string>;
  defaultModel: string;
  temperature: number;
  maxTokens: number;
  showThinking: boolean;
  autoSave: boolean;
}

export const AISettingsTab = memo(() => {
  const [form] = Form.useForm();
  const [settings, setSettings] = useState<AISettings>({
    provider: "zhipu",
    apiKeys: {},
    defaultModel: "glm-4",
    temperature: 0.7,
    maxTokens: 1000,
    showThinking: true,
    autoSave: true,
  });
  const [loading, setLoading] = useState(false);

  useEffect(() => {
    loadSettings();
  }, []);

  const loadSettings = () => {
    try {
      const savedSettings = localStorage.getItem("ai_settings");
      if (savedSettings) {
        const parsed = JSON.parse(savedSettings);
        setSettings(parsed);
        form.setFieldsValue(parsed);
      }
    } catch (error) {
      console.error("åŠ è½½AIè®¾ç½®å¤±è´¥:", error);
    }
  };

  const saveSettings = async (values: AISettings) => {
    setLoading(true);
    try {
      // ä¿å­˜APIå¯†é’¥åˆ°ç‹¬ç«‹çš„å­˜å‚¨
      Object.entries(values.apiKeys).forEach(([provider, key]) => {
        if (key) {
          localStorage.setItem(`ai_${provider}_api_key`, key);
        }
      });

      // ä¿å­˜å…¶ä»–è®¾ç½®
      const settingsToSave = { ...values };
      delete settingsToSave.apiKeys; // ä¸ä¿å­˜æ˜æ–‡å¯†é’¥
      localStorage.setItem("ai_settings", JSON.stringify(settingsToSave));

      // æ›´æ–°AIæœåŠ¡é…ç½®
      aiService.setProvider(values.provider);

      setSettings(values);
      message.success("AIè®¾ç½®å·²ä¿å­˜");
    } catch (error) {
      console.error("ä¿å­˜AIè®¾ç½®å¤±è´¥:", error);
      message.error("ä¿å­˜è®¾ç½®å¤±è´¥");
    } finally {
      setLoading(false);
    }
  };

  const testConnection = async () => {
    const values = form.getFieldsValue();
    setLoading(true);
    try {
      // æµ‹è¯•APIè¿æ¥
      message.info("æ­£åœ¨æµ‹è¯•è¿æ¥...");
      // è¿™é‡Œå¯ä»¥å®ç°å®é™…çš„è¿æ¥æµ‹è¯•
      message.success("è¿æ¥æµ‹è¯•æˆåŠŸ");
    } catch (error) {
      message.error("è¿æ¥æµ‹è¯•å¤±è´¥");
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className={styles.tabContent}>
      <Form
        form={form}
        layout="vertical"
        initialValues={settings}
        onFinish={saveSettings}
        className={styles.settingsForm}
      >
        <Form.Item
          label="AI æœåŠ¡æä¾›å•†"
          name="provider"
          rules={[{ required: true, message: "è¯·é€‰æ‹©AIæœåŠ¡æä¾›å•†" }]}
        >
          <Select>
            <Select.Option value="zhipu">æ™ºè°±AI (GLM)</Select.Option>
            <Select.Option value="openai">OpenAI (GPT)</Select.Option>
          </Select>
        </Form.Item>

        <Form.Item
          label="API å¯†é’¥"
          name={["apiKeys", form.getFieldValue("provider")]}
          rules={[{ required: true, message: "è¯·è¾“å…¥APIå¯†é’¥" }]}
        >
          <Input.Password
            prefix={<KeyOutlined />}
            placeholder="è¯·è¾“å…¥APIå¯†é’¥"
          />
        </Form.Item>

        <Form.Item label="é»˜è®¤æ¨¡å‹" name="defaultModel">
          <Select>
            <Select.Option value="glm-4">GLM-4</Select.Option>
            <Select.Option value="glm-4-plus">GLM-4 Plus</Select.Option>
          </Select>
        </Form.Item>

        <Form.Item label="åˆ›æ„åº¦" name="temperature">
          <Slider
            min={0}
            max={1}
            step={0.1}
            marks={{
              0: "ä¿å®ˆ",
              0.5: "é€‚ä¸­",
              1: "åˆ›æ„",
            }}
          />
        </Form.Item>

        <Form.Item label="æœ€å¤§è¾“å‡ºé•¿åº¦" name="maxTokens">
          <Slider
            min={100}
            max={2000}
            step={100}
            marks={{
              100: "100",
              1000: "1000",
              2000: "2000",
            }}
          />
        </Form.Item>

        <Form.Item name="showThinking" valuePropName="checked">
          <Switch checkedChildren="æ˜¾ç¤º" unCheckedChildren="éšè—" />
          <span style={{ marginLeft: 8 }}>æ˜¾ç¤ºAIæ€ç»´è¿‡ç¨‹</span>
        </Form.Item>

        <Form.Item name="autoSave" valuePropName="checked">
          <Switch checkedChildren="å¼€å¯" unCheckedChildren="å…³é—­" />
          <span style={{ marginLeft: 8 }}>è‡ªåŠ¨ä¿å­˜AIç”Ÿæˆçš„å†…å®¹</span>
        </Form.Item>

        <Form.Item>
          <Button.Group>
            <Button onClick={testConnection} loading={loading}>
              æµ‹è¯•è¿æ¥
            </Button>
            <Button type="primary" htmlType="submit" loading={loading}>
              ä¿å­˜è®¾ç½®
            </Button>
          </Button.Group>
        </Form.Item>
      </Form>
    </div>
  );
});
```

## 8. å®‰å…¨æ€§ä¸æ€§èƒ½è€ƒè™‘ï¼ˆæ¶æ„å¸ˆè¡¥å……ï¼‰

### 8.1 API å¯†é’¥å®‰å…¨ç®¡ç†

```typescript
// src/utils/security.ts
class SecurityManager {
  private static instance: SecurityManager;

  private constructor() {}

  static getInstance(): SecurityManager {
    if (!SecurityManager.instance) {
      SecurityManager.instance = new SecurityManager();
    }
    return SecurityManager.instance;
  }

  // å®‰å…¨å­˜å‚¨APIå¯†é’¥
  setAPIKey(provider: string, key: string): void {
    try {
      // ç®€å•çš„æœ¬åœ°åŠ å¯†ï¼ˆç”Ÿäº§ç¯å¢ƒåº”ä½¿ç”¨æ›´å¼ºçš„åŠ å¯†ï¼‰
      const encrypted = btoa(key);
      localStorage.setItem(`ai_${provider}_api_key`, encrypted);
    } catch (error) {
      console.error("å­˜å‚¨APIå¯†é’¥å¤±è´¥:", error);
      throw new Error("å¯†é’¥å­˜å‚¨å¤±è´¥");
    }
  }

  // å®‰å…¨è·å–APIå¯†é’¥
  getAPIKey(provider: string): string | null {
    try {
      const encrypted = localStorage.getItem(`ai_${provider}_api_key`);
      if (!encrypted) return null;

      return atob(encrypted);
    } catch (error) {
      console.error("è·å–APIå¯†é’¥å¤±è´¥:", error);
      return null;
    }
  }

  // éªŒè¯APIå¯†é’¥æ ¼å¼
  validateAPIKey(provider: string, key: string): boolean {
    const patterns = {
      zhipu: /^[a-zA-Z0-9]{32,}$/,
      openai: /^sk-[a-zA-Z0-9]{48}$/,
    };

    const pattern = patterns[provider as keyof typeof patterns];
    return pattern ? pattern.test(key) : false;
  }

  // æ¸…ç†APIå¯†é’¥
  clearAPIKey(provider: string): void {
    localStorage.removeItem(`ai_${provider}_api_key`);
  }
}

export const securityManager = SecurityManager.getInstance();
```

### 8.2 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

```typescript
// src/hooks/useAIGeneration.ts
import { useCallback, useRef } from "react";
import { useNoteStore } from "../store/noteStore";
import { aiService } from "../services/aiService";

export const useAIGeneration = (noteId: string) => {
  const {
    aiGenerating,
    aiStreamingData,
    aiErrors,
    startAIGeneration,
    cancelAIGeneration,
  } = useNoteStore();

  const abortControllerRef = useRef<AbortController | null>(null);

  // é˜²æŠ–çš„ç”Ÿæˆå‡½æ•°
  const debouncedGenerate = useCallback(
    debounce(async (prompt: string) => {
      try {
        // å–æ¶ˆä¹‹å‰çš„è¯·æ±‚
        if (abortControllerRef.current) {
          abortControllerRef.current.abort();
        }

        abortControllerRef.current = new AbortController();
        await startAIGeneration(noteId, prompt);
      } catch (error) {
        if (error.name !== "AbortError") {
          console.error("AIç”Ÿæˆå¤±è´¥:", error);
        }
      }
    }, 1000),
    [noteId, startAIGeneration]
  );

  const cancelGeneration = useCallback(() => {
    abortControllerRef.current?.abort();
    cancelAIGeneration(noteId);
  }, [noteId, cancelAIGeneration]);

  return {
    isGenerating: aiGenerating[noteId] || false,
    streamingContent: aiStreamingData[noteId] || "",
    error: aiErrors[noteId],
    generate: debouncedGenerate,
    cancel: cancelGeneration,
  };
};

// é˜²æŠ–å·¥å…·å‡½æ•°
function debounce<T extends (...args: any[]) => any>(
  func: T,
  delay: number
): (...args: Parameters<T>) => void {
  let timeoutId: NodeJS.Timeout;

  return (...args: Parameters<T>) => {
    clearTimeout(timeoutId);
    timeoutId = setTimeout(() => func(...args), delay);
  };
}
```

## 9. å®æ–½è·¯çº¿å›¾

### 9.1 MVP é˜¶æ®µï¼ˆ1-2 å‘¨ï¼‰

**ç¬¬ä¸€å‘¨**ï¼š

- [ ] æ‰©å±• noteStore æ·»åŠ  AI æ–¹æ³•
- [ ] å®ç°åŸºç¡€çš„ aiService å’Œæ™ºè°± AI æä¾›å•†
- [ ] åœ¨ NoteToolbar æ·»åŠ  AI æŒ‰é’®
- [ ] å®ç°åŸºæœ¬çš„ AI ç”ŸæˆåŠŸèƒ½

**ç¬¬äºŒå‘¨**ï¼š

- [ ] åœ¨ TiptapEditor ä¸­é›†æˆæ€ç»´é“¾æ˜¾ç¤º
- [ ] æ·»åŠ  AI è®¾ç½®æ ‡ç­¾é¡µ
- [ ] å®ç°æµå¼ç”Ÿæˆå’Œé”™è¯¯å¤„ç†
- [ ] åŸºç¡€æµ‹è¯•å’Œè°ƒè¯•

### 9.2 åŠŸèƒ½å®Œå–„é˜¶æ®µï¼ˆ3-4 å‘¨ï¼‰

**ç¬¬ä¸‰å‘¨**ï¼š

- [ ] ä¼˜åŒ–æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ
- [ ] æ·»åŠ å¤š AI æä¾›å•†æ”¯æŒ
- [ ] å®Œå–„å®‰å…¨æ€§æªæ–½
- [ ] æ·»åŠ ä½¿ç”¨ç»Ÿè®¡å’Œæˆæœ¬è·Ÿè¸ª

**ç¬¬å››å‘¨**ï¼š

- [ ] å…¨é¢æµ‹è¯•å’Œ bug ä¿®å¤
- [ ] ç”¨æˆ·æ–‡æ¡£å’Œå¸®åŠ©
- [ ] ä»£ç ä¼˜åŒ–å’Œé‡æ„
- [ ] å‡†å¤‡å‘å¸ƒ

## 10. å·¥ä½œå° AI é›†æˆæŠ€æœ¯æ–¹æ¡ˆï¼ˆæ¶æ„å¸ˆ&ç ”å‘ç»ç†è¡¥å……ï¼‰

### 10.1 æ ¸å¿ƒæŠ€æœ¯æŒ‘æˆ˜åˆ†æ

**ğŸ¯ å…³é”®é—®é¢˜**ï¼š

1. **å·¥ä½œå°æç¤ºè¯è¾“å…¥** â†’ AI ç”Ÿæˆä¾¿ç­¾çš„å®Œæ•´æµç¨‹
2. **Markdown æµå¼è¾“å‡º** â†’ TipTap HTML æ ¼å¼å®æ—¶è½¬æ¢
3. **æ•°æ®æ ¼å¼ä¸€è‡´æ€§** â†’ JSON å­˜å‚¨ä¸å‰ç«¯æ¸²æŸ“æ ¼å¼ç»Ÿä¸€

### 10.2 æŠ€æœ¯æ¶æ„è®¾è®¡

```
â”Œâ”€ ç”¨æˆ·è¾“å…¥å±‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NoteWorkbench (æç¤ºè¯è¾“å…¥)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ æç¤ºè¯
                  â–¼
â”Œâ”€ AIæœåŠ¡å±‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  aiService.generateFromPrompt()  â”‚ â† æ–°å¢æ–¹æ³•
â”‚  - è°ƒç”¨AI API                    â”‚
â”‚  - æ¥æ”¶Markdownæµ                â”‚
â”‚  - å®æ—¶è½¬æ¢ä¸ºHTML                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ HTMLæµ
                  â–¼
â”Œâ”€ çŠ¶æ€ç®¡ç†å±‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  noteStore (æ‰©å±•)                â”‚
â”‚  - createAINoteFromPrompt()      â”‚ â† æ–°å¢æ–¹æ³•
â”‚  - updateStreamingContent()      â”‚ â† æµå¼æ›´æ–°
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚ ä¾¿ç­¾æ•°æ®
                  â–¼
â”Œâ”€ ç»„ä»¶æ¸²æŸ“å±‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Canvas â†’ NoteCard â†’ TipTap      â”‚
â”‚  (å®æ—¶æ˜¾ç¤ºæµå¼ç”Ÿæˆå†…å®¹)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.3 Markdown åˆ° HTML å®æ—¶è½¬æ¢æ–¹æ¡ˆ

````typescript
// src/utils/markdownConverter.ts
import { unified } from "unified";
import remarkParse from "remark-parse";
import remarkHtml from "remark-html";
import remarkBreaks from "remark-breaks";
import remarkGfm from "remark-gfm";

class MarkdownConverter {
  private processor: any;

  constructor() {
    this.processor = unified()
      .use(remarkParse)
      .use(remarkGfm) // GitHubé£æ ¼Markdown
      .use(remarkBreaks) // æ”¯æŒæ¢è¡Œ
      .use(remarkHtml, {
        sanitize: false, // TipTapéœ€è¦å®Œæ•´HTML
      });
  }

  /**
   * æµå¼è½¬æ¢Markdownç‰‡æ®µåˆ°HTML
   * æ”¯æŒä¸å®Œæ•´çš„Markdownè¾“å…¥
   */
  convertStreamChunk(markdownChunk: string): string {
    try {
      // å¤„ç†æµå¼è¾“å…¥ä¸­çš„ä¸å®Œæ•´è¯­æ³•
      const processedChunk = this.preprocessStreamChunk(markdownChunk);
      const result = this.processor.processSync(processedChunk);
      return this.postprocessHTML(result.toString());
    } catch (error) {
      // è½¬æ¢å¤±è´¥æ—¶è¿”å›åŸå§‹æ–‡æœ¬
      console.warn("Markdownè½¬æ¢å¤±è´¥ï¼Œä½¿ç”¨åŸå§‹æ–‡æœ¬:", error);
      return `<p>${markdownChunk.replace(/\n/g, "<br>")}</p>`;
    }
  }

  /**
   * é¢„å¤„ç†æµå¼Markdownç‰‡æ®µ
   * å¤„ç†ä¸å®Œæ•´çš„è¯­æ³•ç»“æ„
   */
  private preprocessStreamChunk(chunk: string): string {
    // 1. ä¿®å¤ä¸å®Œæ•´çš„åˆ—è¡¨é¡¹
    chunk = chunk.replace(/^- (.*)(?!$)/gm, "- $1\n");

    // 2. ä¿®å¤ä¸å®Œæ•´çš„æ ‡é¢˜
    chunk = chunk.replace(/^(#{1,6})\s+(.*)(?!$)/gm, "$1 $2\n\n");

    // 3. ä¿®å¤ä¸å®Œæ•´çš„ä»£ç å—
    if (chunk.includes("```") && (chunk.match(/```/g) || []).length % 2 === 1) {
      chunk += "\n```"; // ä¸´æ—¶å…³é—­ä»£ç å—
    }

    return chunk;
  }

  /**
   * åå¤„ç†HTMLï¼Œä½¿å…¶ä¸TipTapæ ¼å¼å…¼å®¹
   */
  private postprocessHTML(html: string): string {
    return html
      .replace(/<p><\/p>/g, "<p><br></p>") // ç©ºæ®µè½å¤„ç†
      .replace(/\n\n/g, "\n") // ç§»é™¤å¤šä½™æ¢è¡Œ
      .trim();
  }

  /**
   * å®Œæ•´è½¬æ¢ï¼ˆç”¨äºæœ€ç»ˆç»“æœï¼‰
   */
  convertComplete(markdown: string): string {
    try {
      const result = this.processor.processSync(markdown);
      return this.postprocessHTML(result.toString());
    } catch (error) {
      console.error("å®Œæ•´Markdownè½¬æ¢å¤±è´¥:", error);
      return `<p>${markdown.replace(/\n/g, "<br>")}</p>`;
    }
  }
}

export const markdownConverter = new MarkdownConverter();
````

### 10.4 å·¥ä½œå°é›†æˆå®ç°

```typescript
// src/services/aiService.ts - æ‰©å±•å·¥ä½œå°æ–¹æ³•
class AIService {
  // ... ç°æœ‰ä»£ç 

  /**
   * ä»å·¥ä½œå°æç¤ºè¯ç”Ÿæˆä¾¿ç­¾
   */
  async generateNoteFromPrompt(options: {
    prompt: string;
    canvasId: string;
    position?: Position;
    onStream?: (htmlContent: string, aiData: any) => void;
    onComplete?: (noteId: string, finalContent: string, aiData: any) => void;
    onError?: (error: Error) => void;
  }): Promise<string> {
    try {
      // 1. å…ˆåˆ›å»ºä¸€ä¸ªç©ºä¾¿ç­¾å ä½
      const tempNoteId = await this.createPlaceholderNote(
        options.canvasId,
        options.position
      );

      // 2. å¼€å§‹AIç”Ÿæˆæµç¨‹
      let accumulatedMarkdown = "";
      let accumulatedHTML = "";

      await this.generateContent({
        noteId: tempNoteId,
        prompt: options.prompt,
        onStream: (markdownChunk) => {
          // å®æ—¶è½¬æ¢Markdownåˆ°HTML
          accumulatedMarkdown += markdownChunk;
          accumulatedHTML =
            markdownConverter.convertStreamChunk(accumulatedMarkdown);

          // è§¦å‘æµå¼æ›´æ–°å›è°ƒ
          options.onStream?.(accumulatedHTML, {
            generated: true,
            model: this.currentProvider,
            prompt: options.prompt,
            isStreaming: true,
          });
        },
        onComplete: (finalMarkdown, aiData) => {
          // æœ€ç»ˆè½¬æ¢
          const finalHTML = markdownConverter.convertComplete(finalMarkdown);

          // å®Œæˆå›è°ƒ
          options.onComplete?.(tempNoteId, finalHTML, {
            ...aiData,
            originalMarkdown: finalMarkdown,
            isStreaming: false,
          });
        },
        onError: options.onError,
      });

      return tempNoteId;
    } catch (error) {
      console.error("å·¥ä½œå°AIç”Ÿæˆå¤±è´¥:", error);
      options.onError?.(error as Error);
      throw error;
    }
  }

  /**
   * åˆ›å»ºå ä½ä¾¿ç­¾
   */
  private async createPlaceholderNote(
    canvasId: string,
    position?: Position
  ): Promise<string> {
    const noteStore = useNoteStore.getState();
    return await noteStore.createNote(
      canvasId,
      position || { x: 100, y: 100 },
      NoteColor.YELLOW
    );
  }
}
```

### 10.5 NoteWorkbench é›†æˆ AI åŠŸèƒ½

```typescript
// src/components/NoteWorkbench/index.tsx - æ‰©å±•AIåŠŸèƒ½
export const NoteWorkbench: React.FC<NoteWorkbenchProps> = ({
  canvasId, // æ–°å¢ï¼šå½“å‰ç”»å¸ƒID
  // ... å…¶ä»–ç°æœ‰props
}) => {
  const [isGenerating, setIsGenerating] = useState(false);
  const [streamingContent, setStreamingContent] = useState("");

  /**
   * å¤„ç†æ·»åŠ ä¾¿ç­¾ - å¢å¼ºAIæ”¯æŒ
   */
  const handleAddNote = useCallback(async () => {
    if (disabled || loading) return;

    const prompt = inputValue.trim();
    setStatus("loading");

    try {
      if (prompt) {
        // AIç”Ÿæˆä¾¿ç­¾
        setIsGenerating(true);

        await aiService.generateNoteFromPrompt({
          prompt,
          canvasId,
          position: { x: 200, y: 200 }, // é»˜è®¤ä½ç½®
          onStream: (htmlContent, aiData) => {
            setStreamingContent(htmlContent);
            // å®æ—¶æ›´æ–°UIåé¦ˆ
          },
          onComplete: (noteId, finalContent, aiData) => {
            console.log(`âœ… AIä¾¿ç­¾ç”Ÿæˆå®Œæˆ: ${noteId}`);
            setIsGenerating(false);
            setStreamingContent("");

            // æ¸…ç©ºè¾“å…¥æ¡†å¹¶é‡ç½®çŠ¶æ€
            setInputValue("");
            onChange?.("");
            setStatus("idle");
          },
          onError: (error) => {
            console.error("AIç”Ÿæˆå¤±è´¥:", error);
            setIsGenerating(false);
            setStatus("error");
            setTimeout(() => setStatus("idle"), 2000);
          },
        });
      } else {
        // åˆ›å»ºç©ºç™½ä¾¿ç­¾ï¼ˆç°æœ‰é€»è¾‘ï¼‰
        await onAddNote?.();
        setInputValue("");
        onChange?.("");
        setStatus("idle");
      }
    } catch (error) {
      setStatus("error");
      setIsGenerating(false);
      console.error("æ·»åŠ ä¾¿ç­¾å¤±è´¥:", error);
      setTimeout(() => setStatus("idle"), 2000);
    }
  }, [inputValue, canvasId, disabled, loading, onAddNote, onChange]);

  // UIæ¸²æŸ“å¢å¼º
  return (
    <div className={styles.workbench}>
      <div className={styles.inputContainer}>
        <Input
          value={inputValue}
          onChange={handleInputChange}
          onKeyDown={handleKeyDown}
          placeholder={
            isGenerating
              ? "AIæ­£åœ¨ç”Ÿæˆä¾¿ç­¾..."
              : "è¾“å…¥æç¤ºè¯AIç”Ÿæˆä¾¿ç­¾ï¼Œç•™ç©ºåˆ›å»ºç©ºç™½ä¾¿ç­¾..."
          }
          disabled={disabled || isGenerating}
          suffix={
            <Button
              type="primary"
              loading={isGenerating}
              onClick={handleAddNote}
              disabled={disabled}
            >
              {isGenerating ? "ç”Ÿæˆä¸­..." : "åˆ›å»ºä¾¿ç­¾"}
            </Button>
          }
        />
      </div>

      {/* æ–°å¢ï¼šæµå¼ç”Ÿæˆé¢„è§ˆ */}
      {isGenerating && streamingContent && (
        <div className={styles.streamingPreview}>
          <div className={styles.previewHeader}>
            <span>AIæ­£åœ¨ç”Ÿæˆ...</span>
          </div>
          <div
            className={styles.previewContent}
            dangerouslySetInnerHTML={{ __html: streamingContent }}
          />
        </div>
      )}
    </div>
  );
};
```

## 11. é‡Œç¨‹ç¢‘å¼å¼€å‘è¿›åº¦å®‰æ’

> **å¼€å‘ç­–ç•¥**: æ¯ä¸ªé‡Œç¨‹ç¢‘éƒ½æ˜¯å¯ç‹¬ç«‹ä½¿ç”¨çš„åŠŸèƒ½ç‰ˆæœ¬

### ğŸ¯ é‡Œç¨‹ç¢‘ 1: åŸºç¡€ AI é›†æˆï¼ˆç¬¬ 1-2 å‘¨ï¼‰

**ç›®æ ‡**: å®ç°æœ€åŸºæœ¬çš„ AI ä¾¿ç­¾ç”ŸæˆåŠŸèƒ½

#### ç¬¬ 1 å‘¨ï¼šæ ¸å¿ƒåŸºç¡€è®¾æ–½

- [x] **æ•°æ®ç»“æ„å‡†å¤‡**ï¼ˆ1 å¤©ï¼‰
  - æ‰©å±• Note æ¥å£ customProperties å®šä¹‰
  - åˆ›å»º AI æ•°æ®ç±»å‹å®šä¹‰
- [ ] **æœåŠ¡å±‚åŸºç¡€**ï¼ˆ2 å¤©ï¼‰

  - å®ç° aiService.ts åŸºç¡€æ¶æ„
  - é›†æˆæ™ºè°± AI API è°ƒç”¨
  - å®ç°åŸºç¡€é”™è¯¯å¤„ç†

- [ ] **Markdown è½¬æ¢å·¥å…·**ï¼ˆ2 å¤©ï¼‰
  - å®ç° markdownConverter.ts
  - æ”¯æŒåŸºç¡€ Markdownâ†’HTML è½¬æ¢
  - å•å…ƒæµ‹è¯•

#### ç¬¬ 2 å‘¨ï¼šå·¥ä½œå°é›†æˆ

- [ ] **NoteWorkbench æ‰©å±•**ï¼ˆ2 å¤©ï¼‰

  - é›†æˆ AI ç”ŸæˆæŒ‰é’®
  - å®ç°æç¤ºè¯è¾“å…¥å¤„ç†
  - åŸºç¡€çŠ¶æ€ç®¡ç†

- [ ] **noteStore æ‰©å±•**ï¼ˆ2 å¤©ï¼‰

  - æ·»åŠ  createAINoteFromPrompt æ–¹æ³•
  - é›†æˆ AI æ•°æ®å­˜å‚¨é€»è¾‘

- [ ] **åŸºç¡€æµ‹è¯•**ï¼ˆ1 å¤©ï¼‰
  - ç«¯åˆ°ç«¯æµ‹è¯•
  - åŸºç¡€åŠŸèƒ½éªŒè¯

**âœ… é‡Œç¨‹ç¢‘ 1 äº¤ä»˜æ ‡å‡†**:

- ç”¨æˆ·å¯åœ¨å·¥ä½œå°è¾“å…¥æç¤ºè¯ç”Ÿæˆ AI ä¾¿ç­¾
- AI ç”Ÿæˆçš„å†…å®¹æ­£ç¡®æ˜¾ç¤ºåœ¨ä¾¿ç­¾ä¸­
- åŸºç¡€é”™è¯¯å¤„ç†å’ŒçŠ¶æ€åé¦ˆ

### ğŸ¯ é‡Œç¨‹ç¢‘ 2: æµå¼ä¼ è¾“ä¼˜åŒ–ï¼ˆç¬¬ 3-4 å‘¨ï¼‰

**ç›®æ ‡**: å®ç°å®æ—¶æµå¼æ˜¾ç¤ºï¼Œæå‡ç”¨æˆ·ä½“éªŒ

#### ç¬¬ 3 å‘¨ï¼šæµå¼æ¶æ„

- [ ] **æµå¼è½¬æ¢ä¼˜åŒ–**ï¼ˆ2 å¤©ï¼‰

  - ä¼˜åŒ– markdownConverter æ”¯æŒæµå¼è¾“å…¥
  - å¤„ç†ä¸å®Œæ•´ Markdown è¯­æ³•
  - æ€§èƒ½ä¼˜åŒ–

- [ ] **çŠ¶æ€ç®¡ç†å¢å¼º**ï¼ˆ2 å¤©ï¼‰

  - å®ç° updateStreamingContent æ–¹æ³•
  - æµå¼çŠ¶æ€ç®¡ç†
  - å†…å­˜ç®¡ç†ä¼˜åŒ–

- [ ] **UI å®æ—¶æ›´æ–°**ï¼ˆ1 å¤©ï¼‰
  - NoteWorkbench æµå¼é¢„è§ˆ
  - TipTap ç¼–è¾‘å™¨å®æ—¶æ›´æ–°

#### ç¬¬ 4 å‘¨ï¼šç”¨æˆ·ä½“éªŒä¼˜åŒ–

- [ ] **äº¤äº’ä½“éªŒ**ï¼ˆ2 å¤©ï¼‰

  - å–æ¶ˆç”ŸæˆåŠŸèƒ½
  - é‡è¯•æœºåˆ¶
  - åŠ è½½çŠ¶æ€ä¼˜åŒ–

- [ ] **é”™è¯¯å¤„ç†å®Œå–„**ï¼ˆ1 å¤©ï¼‰

  - ç½‘ç»œé”™è¯¯æ¢å¤
  - API é™é¢å¤„ç†
  - ç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º

- [ ] **æ€§èƒ½æµ‹è¯•**ï¼ˆ2 å¤©ï¼‰
  - æµå¼æ€§èƒ½æµ‹è¯•
  - å†…å­˜æ³„æ¼æ£€æŸ¥
  - å¹¶å‘å¤„ç†æµ‹è¯•

**âœ… é‡Œç¨‹ç¢‘ 2 äº¤ä»˜æ ‡å‡†**:

- AI ç”Ÿæˆè¿‡ç¨‹å®æ—¶å¯è§
- æµç•…çš„æµå¼ä½“éªŒï¼Œæ— å¡é¡¿
- å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶

### ğŸ¯ é‡Œç¨‹ç¢‘ 3: æ€ç»´é“¾é›†æˆï¼ˆç¬¬ 5-6 å‘¨ï¼‰

**ç›®æ ‡**: é›†æˆæ€ç»´é“¾æ˜¾ç¤ºï¼Œå¢å¼º AI é€æ˜åº¦

#### ç¬¬ 5 å‘¨ï¼šæ€ç»´é“¾æ¶æ„

- [ ] **TipTap æ‰©å±•**ï¼ˆ3 å¤©ï¼‰

  - åˆ›å»º ThinkingChainDisplay ç»„ä»¶
  - é›†æˆåˆ° TipTap ç¼–è¾‘å™¨
  - æ€ç»´é“¾æ•°æ®ç»“æ„

- [ ] **AI æœåŠ¡æ‰©å±•**ï¼ˆ2 å¤©ï¼‰
  - æ”¯æŒæ€ç»´é“¾æ•°æ®è§£æ
  - æ™ºè°± AI æ€ç»´é“¾é›†æˆ

#### ç¬¬ 6 å‘¨ï¼šäº¤äº’ä¼˜åŒ–

- [ ] **ç”¨æˆ·äº¤äº’**ï¼ˆ2 å¤©ï¼‰

  - æ€ç»´é“¾æŠ˜å /å±•å¼€
  - æ­¥éª¤è¯¦æƒ…å±•ç¤º
  - æ—¶é—´è½´æ˜¾ç¤º

- [ ] **è§†è§‰è®¾è®¡**ï¼ˆ2 å¤©ï¼‰

  - æ€ç»´é“¾ UI ç»„ä»¶æ ·å¼
  - åŠ¨ç”»æ•ˆæœ
  - ä¸»é¢˜é€‚é…

- [ ] **åŠŸèƒ½æµ‹è¯•**ï¼ˆ1 å¤©ï¼‰
  - æ€ç»´é“¾æ˜¾ç¤ºæµ‹è¯•
  - äº¤äº’åŠŸèƒ½éªŒè¯

**âœ… é‡Œç¨‹ç¢‘ 3 äº¤ä»˜æ ‡å‡†**:

- æ”¯æŒæ€ç»´é“¾çš„ AI æ¨¡å‹æ˜¾ç¤ºæ¨ç†è¿‡ç¨‹
- ç”¨æˆ·å¯æŸ¥çœ‹ AI çš„æ€è€ƒæ­¥éª¤
- è‰¯å¥½çš„è§†è§‰è®¾è®¡å’Œäº¤äº’ä½“éªŒ

### ğŸ¯ é‡Œç¨‹ç¢‘ 4: é«˜çº§åŠŸèƒ½ï¼ˆç¬¬ 7-8 å‘¨ï¼‰

**ç›®æ ‡**: å¤š AI æä¾›å•†ã€é…ç½®ç®¡ç†ã€å®‰å…¨æ€§

#### ç¬¬ 7 å‘¨ï¼šå¤šæä¾›å•†æ”¯æŒ

- [ ] **OpenAI é›†æˆ**ï¼ˆ2 å¤©ï¼‰
  - OpenAIProvider å®ç°
  - API å…¼å®¹æ€§å¤„ç†
- [ ] **æä¾›å•†ç®¡ç†**ï¼ˆ2 å¤©ï¼‰
  - åŠ¨æ€åˆ‡æ¢æœºåˆ¶
  - é…ç½®ç®¡ç†
- [ ] **AI è®¾ç½®é¡µé¢**ï¼ˆ1 å¤©ï¼‰
  - SettingsModal AI æ ‡ç­¾é¡µ
  - é…ç½®ç•Œé¢å®ç°

#### ç¬¬ 8 å‘¨ï¼šå®‰å…¨ä¸ä¼˜åŒ–

- [ ] **å®‰å…¨ç®¡ç†**ï¼ˆ2 å¤©ï¼‰
  - API å¯†é’¥å®‰å…¨å­˜å‚¨
  - è¾“å…¥éªŒè¯å’Œè¿‡æ»¤
- [ ] **æ€§èƒ½ä¼˜åŒ–**ï¼ˆ2 å¤©ï¼‰
  - ç¼“å­˜æœºåˆ¶
  - è¯·æ±‚ä¼˜åŒ–
  - å†…å­˜ç®¡ç†
- [ ] **å®Œæ•´æµ‹è¯•**ï¼ˆ1 å¤©ï¼‰
  - é›†æˆæµ‹è¯•
  - æ€§èƒ½æµ‹è¯•
  - å®‰å…¨æµ‹è¯•

**âœ… é‡Œç¨‹ç¢‘ 4 äº¤ä»˜æ ‡å‡†**:

- æ”¯æŒå¤šä¸ª AI æä¾›å•†åˆ‡æ¢
- å®Œå–„çš„é…ç½®ç®¡ç†ç•Œé¢
- ä¼ä¸šçº§å®‰å…¨æ€§å’Œæ€§èƒ½

### ğŸ¯ é‡Œç¨‹ç¢‘ 5: ç”Ÿäº§å°±ç»ªï¼ˆç¬¬ 9-10 å‘¨ï¼‰

**ç›®æ ‡**: ç”Ÿäº§ç¯å¢ƒä¼˜åŒ–ï¼Œæ–‡æ¡£å®Œå–„

#### ç¬¬ 9 å‘¨ï¼šç”Ÿäº§ä¼˜åŒ–

- [ ] **é”™è¯¯ç›‘æ§**ï¼ˆ2 å¤©ï¼‰
  - é”™è¯¯ä¸ŠæŠ¥æœºåˆ¶
  - æ€§èƒ½ç›‘æ§
  - ç”¨æˆ·è¡Œä¸ºç»Ÿè®¡
- [ ] **ä¼˜åŒ–è°ƒè¯•**ï¼ˆ2 å¤©ï¼‰
  - ä»£ç ä¼˜åŒ–
  - Bundle åˆ†æ
  - æ€§èƒ½è°ƒä¼˜
- [ ] **å…¼å®¹æ€§æµ‹è¯•**ï¼ˆ1 å¤©ï¼‰
  - æµè§ˆå™¨å…¼å®¹æ€§
  - è®¾å¤‡é€‚é…æµ‹è¯•

#### ç¬¬ 10 å‘¨ï¼šæ–‡æ¡£ä¸å‘å¸ƒ

- [ ] **ç”¨æˆ·æ–‡æ¡£**ï¼ˆ2 å¤©ï¼‰
  - AI åŠŸèƒ½ä½¿ç”¨æŒ‡å—
  - é…ç½®è¯´æ˜æ–‡æ¡£
  - æ•…éšœæ’é™¤æŒ‡å—
- [ ] **å¼€å‘æ–‡æ¡£**ï¼ˆ1 å¤©ï¼‰
  - API æ–‡æ¡£æ›´æ–°
  - æ¶æ„æ–‡æ¡£å®Œå–„
- [ ] **å‘å¸ƒå‡†å¤‡**ï¼ˆ2 å¤©ï¼‰
  - ç‰ˆæœ¬æ‰“åŒ…
  - å‘å¸ƒæµç¨‹
  - å›æ»šæ–¹æ¡ˆ

**âœ… é‡Œç¨‹ç¢‘ 5 äº¤ä»˜æ ‡å‡†**:

- ç”Ÿäº§çº§åˆ«çš„ç¨³å®šæ€§å’Œæ€§èƒ½
- å®Œå–„çš„ç”¨æˆ·å’Œå¼€å‘æ–‡æ¡£
- å¯é çš„å‘å¸ƒå’Œè¿ç»´æµç¨‹

## 12. è´¨é‡ä¿è¯ç­–ç•¥

### 12.1 ä»£ç è´¨é‡

- **å•å…ƒæµ‹è¯•è¦†ç›–ç‡**: â‰¥80%
- **é›†æˆæµ‹è¯•**: å…³é”®ç”¨æˆ·è·¯å¾„ 100%è¦†ç›–
- **ä»£ç å®¡æŸ¥**: æ‰€æœ‰ AI ç›¸å…³ä»£ç å¼ºåˆ¶å®¡æŸ¥

### 12.2 æ€§èƒ½æŒ‡æ ‡

- **AI å“åº”æ—¶é—´**: é¦–å­—ç¬¦<2 ç§’
- **æµå¼å»¶è¿Ÿ**: <200ms
- **å†…å­˜ä½¿ç”¨**: é•¿æ—¶é—´ä½¿ç”¨æ— æ³„æ¼
- **ç”¨æˆ·ç•Œé¢å“åº”**: æµå¼è¿‡ç¨‹ä¸­ç•Œé¢æµç•…æ— å¡é¡¿

### 12.3 ç”¨æˆ·ä½“éªŒ

- **é”™è¯¯æ¢å¤**: ç½‘ç»œé”™è¯¯è‡ªåŠ¨é‡è¯•
- **çŠ¶æ€åé¦ˆ**: æ¯ä¸ªæ“ä½œéƒ½æœ‰æ˜ç¡®çš„çŠ¶æ€æŒ‡ç¤º
- **å–æ¶ˆæ“ä½œ**: ç”¨æˆ·å¯éšæ—¶å–æ¶ˆ AI ç”Ÿæˆè¿‡ç¨‹

## 13. é£é™©è¯„ä¼°ä¸åº”å¯¹

### 13.1 æŠ€æœ¯é£é™©

| é£é™©é¡¹       | æ¦‚ç‡ | å½±å“ | åº”å¯¹ç­–ç•¥               |
| ------------ | ---- | ---- | ---------------------- |
| AI API é™é¢  | ä¸­   | é«˜   | å¤šæä¾›å•†å¤‡é€‰ï¼Œé…é¢ç›‘æ§ |
| æµå¼è½¬æ¢æ€§èƒ½ | ä½   | ä¸­   | æ¸è¿›å¼æ¸²æŸ“ï¼Œæ€§èƒ½ç›‘æ§   |
| æ•°æ®æ ¼å¼å…¼å®¹ | ä½   | é«˜   | å…¨é¢æµ‹è¯•ï¼Œå‘åå…¼å®¹     |

### 13.2 ç”¨æˆ·ä½“éªŒé£é™©

| é£é™©é¡¹       | æ¦‚ç‡ | å½±å“ | åº”å¯¹ç­–ç•¥             |
| ------------ | ---- | ---- | -------------------- |
| AI ç”Ÿæˆè´¨é‡  | ä¸­   | ä¸­   | æç¤ºè¯ä¼˜åŒ–ï¼Œç”¨æˆ·æ•™è‚² |
| å“åº”æ—¶é—´è¿‡é•¿ | ä¸­   | é«˜   | æµå¼æ˜¾ç¤ºï¼Œè¶…æ—¶å¤„ç†   |
| ç•Œé¢å¤æ‚åº¦   | ä½   | ä¸­   | æ¸è¿›å¼åŠŸèƒ½å±•ç¤º       |

## 14. æ€»ç»“

### ğŸ¯ æŠ€æœ¯æ–¹æ¡ˆæ ¸å¿ƒä»·å€¼

ä½œä¸ºæ¶æ„å¸ˆå’Œç ”å‘ç»ç†ï¼Œæœ¬æ–¹æ¡ˆè§£å†³äº† AI é›†æˆçš„ä¸‰å¤§æ ¸å¿ƒæŒ‘æˆ˜ï¼š

1. **å·¥ä½œå°æ— ç¼é›†æˆ**ï¼š

   - æç¤ºè¯è¾“å…¥ â†’ AI ç”Ÿæˆ â†’ ä¾¿ç­¾åˆ›å»ºçš„å®Œæ•´é—­ç¯
   - ç”¨æˆ·ä½“éªŒä¸ç°æœ‰å·¥ä½œæµå®Œå…¨ä¸€è‡´
   - æ”¯æŒç©ºç™½ä¾¿ç­¾å’Œ AI ç”Ÿæˆä¾¿ç­¾çš„ç»Ÿä¸€åˆ›å»º

2. **æ•°æ®æ ¼å¼ç»Ÿä¸€**ï¼š

   - Markdown æµå¼è¾“å…¥ â†’ HTML å®æ—¶è½¬æ¢ â†’ TipTap æ ¼å¼
   - å®Œç¾æ”¯æŒ GitHub é£æ ¼ Markdown
   - å¤„ç†æµå¼è¾“å…¥ä¸­çš„ä¸å®Œæ•´è¯­æ³•

3. **æ¶æ„å®Œç¾èåˆ**ï¼š
   - æ‰©å±•ç°æœ‰ç»„ä»¶è€Œéé‡å»º
   - åˆ©ç”¨ç°æœ‰çš„æ€§èƒ½ä¼˜åŒ–å’Œé”™è¯¯å¤„ç†æœºåˆ¶
   - ä¿æŒå‘åå…¼å®¹æ€§å’Œæ•°æ®ä¸€è‡´æ€§

### ğŸ“Š å¼€å‘è¿›åº¦ä¿è¯

**é‡Œç¨‹ç¢‘å¼å¼€å‘ç­–ç•¥**ç¡®ä¿ï¼š

- âœ… æ¯ä¸ªé˜¶æ®µéƒ½æœ‰å¯ç”¨çš„åŠŸèƒ½ç‰ˆæœ¬
- âœ… é£é™©å¯æ§ï¼Œé—®é¢˜å¯åŠæ—¶å‘ç°å’Œä¿®å¤
- âœ… ç”¨æˆ·å¯ä»¥é€æ­¥ä½“éªŒæ–°åŠŸèƒ½
- âœ… å¼€å‘å›¢é˜Ÿå¯ä»¥æŒç»­è·å¾—åé¦ˆå’Œæ”¹è¿›

### ğŸ›¡ï¸ è´¨é‡ä¸é£é™©æ§åˆ¶

**å…¨é¢çš„è´¨é‡ä¿è¯ä½“ç³»**ï¼š

- ä»£ç è´¨é‡ï¼š80%æµ‹è¯•è¦†ç›–ç‡ + å¼ºåˆ¶ä»£ç å®¡æŸ¥
- æ€§èƒ½æŒ‡æ ‡ï¼šæ˜ç¡®çš„å“åº”æ—¶é—´å’Œå†…å­˜ä½¿ç”¨æ ‡å‡†
- ç”¨æˆ·ä½“éªŒï¼šå®Œå–„çš„é”™è¯¯æ¢å¤å’ŒçŠ¶æ€åé¦ˆæœºåˆ¶

**ä¸»åŠ¨çš„é£é™©ç®¡ç†**ï¼š

- æŠ€æœ¯é£é™©ï¼šå¤šæä¾›å•†å¤‡é€‰ï¼Œæ€§èƒ½ç›‘æ§
- ä½“éªŒé£é™©ï¼šæµå¼æ˜¾ç¤ºï¼Œæ¸è¿›å¼åŠŸèƒ½å±•ç¤º
- è¿è¥é£é™©ï¼šå®Œå–„çš„ç›‘æ§å’Œå›æ»šæœºåˆ¶

### ğŸš€ å®æ–½å»ºè®®

1. **ç«‹å³å¼€å§‹é‡Œç¨‹ç¢‘ 1**ï¼šåŸºç¡€è®¾æ–½å·²ç»å‡†å¤‡å°±ç»ª
2. **é‡ç‚¹å…³æ³¨æµå¼ä½“éªŒ**ï¼šè¿™æ˜¯ç”¨æˆ·æ„ŸçŸ¥çš„æ ¸å¿ƒä»·å€¼
3. **æŒç»­ç”¨æˆ·æµ‹è¯•**ï¼šæ¯ä¸ªé‡Œç¨‹ç¢‘éƒ½éœ€è¦ç”¨æˆ·éªŒè¯
4. **ä¿æŒæ¶æ„ä¸€è‡´æ€§**ï¼šä¸¥æ ¼éµå¾ªç°æœ‰çš„è®¾è®¡æ¨¡å¼

ç»è¿‡ä¸“ä¸šæ¶æ„å¸ˆå®¡æŸ¥å’Œç ”å‘ç»ç†è§„åˆ’ï¼Œæœ¬æŒ‡å—ä¸º InfinityNote2 çš„ AI åŠŸèƒ½é›†æˆæä¾›äº†å®Œæ•´çš„æŠ€æœ¯è·¯å¾„å’Œå®æ–½ä¿è¯ã€‚éµå¾ªæ­¤æ–¹æ¡ˆå®æ–½ï¼Œå°†ç¡®ä¿ AI åŠŸèƒ½ä¸ç°æœ‰æ¶æ„çš„å®Œç¾èåˆï¼ŒåŒæ—¶ä¸ºç”¨æˆ·æä¾›æµç•…ã€æ™ºèƒ½çš„ä¾¿ç­¾åˆ›å»ºä½“éªŒã€‚
